document.addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("statusValue"),t=document.getElementById("userEmail"),n=document.getElementById("subscriptionExpires"),s=chrome.runtime.getManifest(),a=document.getElementById("version");a&&s.version&&(a.textContent="v"+s.version);const o=async()=>{try{const s=await chrome.storage.local.get(["authToken","userEmail","userSubscription"]),a=!!s.authToken,o=s.userEmail||"Não logado",c=s.userSubscription||null;if(a?(e.textContent="✅ Conectado",e.className="status-value connected"):(e.textContent="⚠️ Aguardando login",e.className="status-value disconnected"),t.textContent=o,c){const e=new Date(c),t=new Date;if(t>e)n.textContent="❌ Expirada",n.className="status-value disconnected";else{const s=Math.ceil((e-t)/864e5);n.textContent=`✅ ${s} dias`,n.className="status-value connected"}}else n.textContent="-",n.className="status-value"}catch(t){e.textContent="Erro",e.className="status-value disconnected"}};o(),setInterval(o,2e3),chrome.storage.local.onChanged.addListener(e=>{o()})});