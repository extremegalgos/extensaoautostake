chrome.runtime.onMessage.addListener((e,s,t)=>{"FORCE_ODDS_COLLECTION"===e.type&&(e.silent,window.postMessage({type:"AUTO_STAKE_FORCE_COLLECTION",bookmakerKey:e.bookmakerKey,bookmakerName:e.bookmakerName,silent:e.silent||!1},"*"),t({success:!0}))}),window.addEventListener("message",async e=>{if(e.source!==window)return;const s=e.data;if(s&&s.type&&s.type.startsWith("AUTO_STAKE_"))if("AUTO_STAKE_PING"!==s.type)if("AUTO_STAKE_SAVE_AUTH"!==s.type)if("AUTO_STAKE_CLEAR_AUTH"!==s.type)if("AUTO_STAKE_OPENING_BOOKMAKERS"!==s.type){if("AUTO_STAKE_REQUEST"===s.type)try{chrome.runtime.sendMessage({type:"AUTO_STAKE_ACTION",action:s.action,requestId:s.requestId,data:s.data},e=>{chrome.runtime.lastError?window.postMessage({type:"AUTO_STAKE_RESPONSE",requestId:s.requestId,action:s.action,success:!1,error:chrome.runtime.lastError.message},"*"):window.postMessage({type:"AUTO_STAKE_RESPONSE",requestId:s.requestId,action:s.action,...e},"*")})}catch(e){window.postMessage({type:"AUTO_STAKE_RESPONSE",requestId:s.requestId,action:s.action,success:!1,error:e.message},"*")}}else chrome.runtime.sendMessage({type:"PREPARE_ARB_SESSION",sessionId:s.sessionId,bookmakers:s.bookmakers}).catch(e=>{});else"undefined"!=typeof chrome&&chrome.storage&&chrome.storage.local&&chrome.storage.local.set({authToken:null,userEmail:null,userId:null,syncTimestamp:null});else"undefined"!=typeof chrome&&chrome.storage&&chrome.storage.local&&chrome.storage.local.set({authToken:s.authToken,userEmail:s.userEmail,userId:s.userId,userSubscription:s.subscriptionExpires||null,syncTimestamp:Date.now()});else window.postMessage({type:"AUTO_STAKE_PONG",version:"1.0.1"},"*")}),chrome.runtime.onMessage.addListener((e,s,t)=>("AUTO_STAKE_NOTIFICATION"===e.type&&window.postMessage({type:"AUTO_STAKE_NOTIFICATION",...e},"*"),!1)),window.postMessage({type:"AUTO_STAKE_READY",version:"1.0.1"},"*"),(document.URL.includes("dp-iframe")||document.URL.includes("sports.pinnacle.bet.br")||document.URL.includes("btsbrplayground.net"))&&window.addEventListener("message",e=>{if("getOdds"===e.data.action){let e=null,s=null;if(e=document.querySelector("span.OddsStyled-sc-1373leq-0 span"),!e){const s=document.querySelector("obg-m-betslip-selection");s&&(e=s.querySelector("span[test-id='odds']"))}e&&e.textContent?(s=e.textContent.trim(),window.parent.postMessage({action:"oddsResponse",value:s},"*")):window.parent.postMessage({action:"oddsResponse",value:null},"*")}if("setStake"===e.data.action){const s=e.data.value;let t=document.querySelector("input[name='stake']")||document.querySelector("input[placeholder*='Risco']");if(!t){const e=document.querySelector("obg-m-betslip-selection");e&&(t=e.querySelector("input[test-id='stake.input']"))}t?(t.focus(),t.value=s,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0})),t.blur(),window.parent.postMessage({action:"stakeResponse",success:!0},"*")):window.parent.postMessage({action:"stakeResponse",success:!1},"*")}});